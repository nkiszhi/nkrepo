<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>恶意文件样本查询</title>
    <!--<link rel="stylesheet" href="{{url_for('static', filename='css/search.css')}}">-->
    <link rel="shortcut icon" href="../static/shield-check.svg" type="image/x-icon">
    <!-- Bootstrap core CSS -->
    <link href="{{url_for('static', filename='css/bootstrap.min.css')}}" rel="stylesheet">
    <!-- Custom styles for form -->
    <link href="{{url_for('static', filename='css/form-validation.css')}}" rel="stylesheet">
</head>

<body class="bg-light">

<!-- 页面公共头部 导航栏 -->
<div id="headerpage">
    {% include "header.html" %}
</div>
<!--主体-->
<div class="container">
    <div class="text-center">
    <!--检测结果, 如果检测成功，显示card信息，如果检测失败，显示错误信息-->
    {% if status == 401 %}
        <h2 class="text-primary">多模型检测结果</h2>
<!--        <p class="text-muted text-secondary">{{message}}</p>-->

    {% elif status == 301 %}
        <h2 class="text-primary">多模型检测结果</h2>
        <p class="text-muted text-secondary">检测文件为：<b>{{filename}}</b> </p>
           <div class="card-body" style="padding: 0 1.25rem;" >
             <div class="table-responsive">
                <table class="table table-sm" style="margin-bottom: 0;text-align: left;">
                   <thead>
                     <tr>
                       <th>文件特征</th>
                     </tr>
                   </thead>
                    <tbody>
                        <svg xmlns="http://www.w3.org/2000/svg" width="30px" height="30px" fill="#dc3545" class="bi bi-x-circle-fill" viewBox="0 0 16 16" style="margin-bottom: 5px;">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
                        </svg>
                         <tr><td>MD5：{{MD5}}<td></tr>
                         <tr><td>SHA-256：{{SHA256}}<td></tr>
                         {% if category %}  
                         <tr><td>category：{{category}}<td></tr>
                         {% endif %}
                         {% if platform %}
                         <tr><td>platform：{{platform}}<td></tr>
                         {% endif %}
                         {% if family %} 
                         <tr><td>family：{{family}}<td></tr>
                         {% endif %}
                         {% if result %}
                         <tr><td>result：{{result}}<td></tr>
                         {% endif %}
                         {% if filetype %}
                         <tr><td>result：{{filetype}}<td></tr>
                         {% endif %}
                         <tr><td>File_size：{{file_sizes}}<td></tr>
                    </tbody>
                </table>
            </div>
        </div>
 <div class="card" >  
    <div class="card-body" style="margin-top: 10px;">  
        <div class="table-responsive">  
            <table class="table table-striped table-bordered table-sm">  
                <thead>  
                    <tr>  
                        <th>检测模型</th>  
                        <th>良性概率</th>  
                        <th>恶意概率</th>  
                        <th>结果</th>  
                    </tr>  
                </thead>  
                <tbody>  
                    {% for model in exe_result %}  
                    <tr>  
                        <td>{{ model }}</td>  
                        <td>{{ exe_result[model][0] }}</td>  
                        <td>{{ exe_result[model][1] }}</td>  
                        <td class="{% if exe_result[model][0] > exe_result[model][1] %}text-success{% else %}text-danger{% endif %}">  
                            {% if exe_result[model][0] > exe_result[model][1] %}  
                                <i class="fas fa-check"></i> 安全  
                            {% else %}  
                                <i class="fas fa-exclamation-triangle"></i> 危险  
                            {% endif %}  
                        </td>  
                    </tr>  
                    {% endfor %}  
                </tbody>  
            </table>  
        </div>  
    </div>  
 </div>
    {% elif status == 300 %}
        <h2 class="text-primary">多模型检测结果</h2>
        <p class="text-muted text-secondary">检测文件为：<b>{{filename}}</b> </p>
           <div class="card-body" style="padding: 0 1.25rem;" >
             <div class="table-responsive">
                <table class="table table-sm" style="margin-bottom: 0;text-align: left;">
                   <thead>
                     <tr>
                       <th>文件特征</th>
                     </tr>
                   </thead>
                    <tbody>
                        <svg xmlns="http://www.w3.org/2000/svg" width="30px" height="30px" fill="#dc3545" class="bi bi-x-circle-fill" viewBox="0 0 16 16" style="margin-bottom: 5px;">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
                        </svg>
                         <tr><td>MD5：{{str_md5}}<td></tr>
                         <tr><td>SHA-256：{{str_sha256}}<td></tr>
                         <tr><td>File_size：{{file_sizes}}<td></tr>
                   </tbody>
                </table>      
             </div>
           </div>
 <div class="card" style="margin-top: 10px;" >  
    <div class="card-body" style="margin-top: 10px;">  
        <div class="table-responsive">  
            <table class="table table-striped table-bordered table-sm">  
                <thead>  
                    <tr>  
                        <th>检测模型</th>  
                        <th>良性概率</th>  
                        <th>恶意概率</th>  
                        <th>结果</th>  
                    </tr>  
                </thead>  
                <tbody>  
                    {% for model in exe_result %}  
                    <tr>  
                        <td>{{ model }}</td>  
                        <td>{{ exe_result[model][0] }}</td>  
                        <td>{{ exe_result[model][1] }}</td>  
                        <td class="{% if exe_result[model][0] > exe_result[model][1] %}text-success{% else %}text-danger{% endif %}">  
                            {% if exe_result[model][0] > exe_result[model][1] %}  
                                <i class="fas fa-check"></i> 安全  
                            {% else %}  
                                <i class="fas fa-exclamation-triangle"></i> 危险  
                            {% endif %}  
                        </td>  
                    </tr>  
                    {% endfor %}  
                </tbody>  
            </table>  
        </div>  
    </div>  
 </div>
    
    {% endif %}   
    <!--返回按钮-->
    <p> <a class="btn btn-primary btn-lg btn-block" href="{{'/file'}}">返回</a> </p>
</div>
<!--页脚-->
<div id="footerpage">
    {%  include 'footer.html' %}
</div>


</body>
</html>

