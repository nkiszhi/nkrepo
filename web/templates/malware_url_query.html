<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>恶意代码样本查询</title>
    <!--<link rel="stylesheet" href="{{url_for('static', filename='css/search.css')}}">-->
    <link rel="shortcut icon" href="../static/shield-check.svg" type="image/x-icon">
    <!-- Bootstrap core CSS -->
    <link href="{{url_for('static', filename='css/bootstrap.min.css')}}" rel="stylesheet">
    <!-- Custom styles for form -->
    <link href="{{url_for('static', filename='css/form-validation.css')}}" rel="stylesheet">
    <!--jquery-->
    <script type="text/javascript" src="{{ url_for('static', filename='js/jquery.js') }}"></script>
    <!-- echart js-->
    <script type="text/javascript" src="{{url_for('static', filename='js/echarts.min.js') }}"></script>
</head>

<body class="bg-light">

<!-- 页面公共头部 导航栏 -->
<div id="headerpage">
    {% include "header.html" %}

</div>
<div class="container">
    <div class="text-center">
	    <img class="d-block mx-auto mb-4 animated-gif" src="{{url_for('static', filename='protect.gif')}}" alt="" width="72" height="72">
        <h2 class="text-primary">恶意域名检测</h2>
	    <p class="text-muted text-secondary">本检测系统在多种检测模型的基础上基于可信度实现恶意域名检测。
    </div>
    <!-- 恶意域名输入框 -->
    <form action="{{url_for('detect_url')}}", method="POST" role="form" class="form-horizontal">
    <div class="input-group form-group">
        <input type="text" class="form-control rounded" placeholder="检测域名或URL", name='url' />
	    <!-- 搜索按件 -->
        <button type="submit" class="btn btn-outline-primary" name="detect-url">
	    <!-- 嵌入搜索图标 -->
	    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
	        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path>
	    </svg>
	    查询
	</button>
    </div>
    </form>
    <!--域名样本库-->
    <div class="jumbotron" style="padding:1rem 1rem; margin-top: 25px; font-size: 13px;">
      <div class="col-sm-12">
        <p><b>域名样本库</b>中包含了良性样本（正常域名）和恶意样本（恶意域名）两类数据，其中<b>良性样本共660471个</b>，采集自Alexa网站前100万域名列表，<b>恶意样本共7449471个</b>，采集自各大知名威胁情报平台（如xxx）。本检测系统在该样本库的基础上训练得到。</p>
        <!--恶意域名统计图, canvas标签会导致echarts的tooltip无法显示-->
        <div class="my-4 w-100" id="echart4" style="height: 380px;"></div>
      </div>
    </div>

<!--页脚-->
<div id="footerpage">
    {%  include 'footer.html' %}
</div>
</div>


</body>
</html>

<script type="text/javascript">
var dom = document.getElementById("echart4");
var echart4 = echarts.init(dom, {devicePixelRatio: 2.5});
var app = {};
option = null;
var dataMap = {};

option = {
    backgroundColor:"#f8f9fa",
    title:{
        show:true,
        text:"恶意样本采集数量统计图",
        x: "center",
        y: 20,
        textStyle:{fontSize:17,}
    },
    tooltip: {
        show:true,
        trigger: 'axis',
        axisPointer: {lineStyle: {color: 'red'}},
    },
    grid: {
        left: '3%',
        right: '6%',
        bottom: '10%',
        containLabel: true
    },

    xAxis: [{
        name:'(日)',
        nameTextStyle: {color: '#343a40'},
        type: 'category',
        boundaryGap: false,
        axisLabel:  {
                rotate:45,
                interval: 15,
                textStyle: {
 					color: "#343a40",
					fontSize:12,
                },
            },
        axisLine: {
			lineStyle: {
				color: '#343a40'
			}
        },
        data: ['2019-10-31', '2019-11-01', '2019-11-02', '2019-11-03', '2019-11-04', '2019-11-05', '2019-11-06', '2019-11-07', '2019-11-08', '2019-11-09', '2019-11-10', '2019-11-11', '2019-11-12', '2019-11-13', '2019-11-14', '2019-11-15', '2019-11-16', '2019-11-17', '2019-11-18', '2019-11-19', '2019-11-20', '2019-11-21', '2019-11-22', '2019-11-23', '2019-11-24', '2019-11-25', '2019-11-26', '2019-11-27', '2019-11-28', '2019-11-29', '2019-11-30', '2019-12-01', '2019-12-02', '2019-12-03', '2019-12-04', '2019-12-05', '2019-12-06', '2019-12-07', '2019-12-08', '2019-12-09', '2019-12-10', '2019-12-11', '2019-12-12', '2019-12-13', '2019-12-14', '2019-12-15', '2019-12-16', '2019-12-17', '2019-12-18', '2019-12-19', '2019-12-20', '2019-12-21', '2019-12-22', '2019-12-23', '2019-12-24', '2019-12-25', '2019-12-26', '2019-12-27', '2019-12-28', '2019-12-29', '2019-12-30', '2019-12-31', '2020-01-01', '2020-01-02', '2020-01-03', '2020-01-04', '2020-01-05', '2020-01-06', '2020-01-07', '2020-01-08', '2020-01-09', '2020-01-10', '2020-01-11', '2020-01-12', '2020-01-13', '2020-01-14', '2020-01-15', '2020-01-16', '2020-01-17', '2020-01-18', '2020-01-19', '2020-01-20', '2020-01-21', '2020-01-22', '2020-01-23', '2020-01-24', '2020-01-25', '2020-01-26', '2020-01-27', '2020-01-28', '2020-01-29', '2020-01-30', '2020-01-31', '2020-02-01', '2020-02-02', '2020-02-03', '2020-02-04', '2020-02-05', '2020-02-06', '2020-02-07', '2020-02-08', '2020-02-09', '2020-02-10', '2020-02-11', '2020-02-12', '2020-02-13', '2020-02-14', '2020-02-15', '2020-02-16', '2020-02-17', '2020-02-18', '2020-02-19', '2020-02-20', '2020-02-21', '2020-02-22', '2020-02-23', '2020-02-24', '2020-02-25', '2020-02-26', '2020-02-27', '2020-02-28', '2020-02-29', '2020-03-01', '2020-03-02', '2020-03-03', '2020-03-04', '2020-03-05', '2020-03-06', '2020-03-07', '2020-03-08', '2020-03-09', '2020-03-10', '2020-03-11', '2020-03-12', '2020-03-13', '2020-03-14', '2020-03-15', '2020-03-16', '2020-03-17', '2020-03-18', '2020-03-19', '2020-03-20', '2020-03-21', '2020-03-22', '2020-03-23', '2020-03-24', '2020-03-25', '2020-03-26', '2020-03-27', '2020-03-28', '2020-03-29', '2020-03-30', '2020-03-31', '2020-04-01', '2020-04-02', '2020-04-03', '2020-04-04', '2020-04-05', '2020-04-06', '2020-04-07', '2020-04-08', '2020-04-09', '2020-04-10', '2020-04-11', '2020-04-12', '2020-04-13', '2020-04-14', '2020-04-15', '2020-04-16', '2020-04-17', '2020-04-18', '2020-04-19', '2020-04-20', '2020-04-21', '2020-04-22', '2020-04-23', '2020-04-24', '2020-04-25', '2020-04-26', '2020-04-27', '2020-04-28', '2020-04-29', '2020-04-30', '2020-05-01', '2020-05-02', '2020-05-03', '2020-05-04', '2020-05-05', '2020-05-06', '2020-05-07', '2020-05-08', '2020-05-09', '2020-05-10', '2020-05-11', '2020-05-12', '2020-05-13', '2020-05-14', '2020-05-15', '2020-05-16', '2020-05-17', '2020-05-18', '2020-05-19', '2020-05-20', '2020-05-21', '2020-05-22', '2020-05-23', '2020-05-24', '2020-05-25', '2020-05-26', '2020-05-27', '2020-05-28', '2020-05-29', '2020-05-30', '2020-05-31', '2020-06-01', '2020-06-02', '2020-06-03', '2020-06-04', '2020-06-05', '2020-06-06', '2020-06-07', '2020-06-08', '2020-06-09', '2020-06-10', '2020-06-11', '2020-06-12', '2020-06-13', '2020-06-14', '2020-06-15', '2020-06-16', '2020-06-17', '2020-06-18', '2020-06-19', '2020-06-20', '2020-06-21', '2020-06-22', '2020-06-23', '2020-06-24', '2020-06-25', '2020-06-26', '2020-06-27', '2020-06-28', '2020-06-29', '2020-06-30', '2020-07-01', '2020-07-02', '2020-07-03', '2020-07-04', '2020-07-05', '2020-07-06', '2020-07-07', '2020-07-08', '2020-07-09', '2020-07-10', '2020-07-11', '2020-07-12', '2020-07-13', '2020-07-14', '2020-07-15', '2020-07-16', '2020-07-17', '2020-07-18', '2020-07-19', '2020-07-20', '2020-07-21', '2020-07-22', '2020-07-23', '2020-07-24', '2020-07-25', '2020-07-26', '2020-07-27', '2020-07-28', '2020-07-29', '2020-07-30', '2020-07-31', '2020-08-01', '2020-08-02', '2020-08-03', '2020-08-04', '2020-08-05', '2020-08-06', '2020-08-07', '2020-08-08', '2020-08-09', '2020-08-10', '2020-08-11', '2020-08-12', '2020-08-13', '2020-08-14', '2020-08-15', '2020-08-16', '2020-08-17', '2020-08-18', '2020-08-19', '2020-08-20', '2020-08-21', '2020-08-22'],
    }, {
        axisPointer: {show: false},
        axisLine: {  show: false},
        position: 'bottom',
        offset: 20,
    }],

    yAxis: [{
        name: '(恶意样本数)',
        nameTextStyle: {color: '#343a40'},
        type: 'value',
        axisTick: {show: false},
        axisLine: {
            lineStyle: {
                color: '#343a40'
            }
        },
       axisLabel:  {
            formatter: function(value,index){
                      var value;
                      value = value/10000+'w'
                      return value; },

            textStyle: {
                color: "#343a40",
                fontSize:13,
            },
       },

        splitLine: {
            lineStyle: {
                 color: 'rgb(108,117,125,0.2)'
            }
        }
    }],
    series: [
        {
        name: '恶意样本数',
        type: 'line',
        smooth: true,
        symbol: 'circle',
        symbolSize: 5,
        showSymbol: false,
        lineStyle: {
            normal: {
				color: '#007bff',
                width: 1
            }
        },
        areaStyle: {
            normal: {
                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{
                    offset: 0,
                    color: 'rgba(0, 123, 255, 0.4)'
                }, {
                    offset: 0.8,
                    color: 'rgba(0, 123, 255, 0.1)'
                }], false),
                shadowColor: 'rgba(0, 0, 0, 0.1)',
            }
        },
        itemStyle: {
        normal: {
            color: 'red',
            borderColor: 'red',
            borderWidth: 6
            }
		},
        data: [871720, 888167, 887926, 889030, 851257, 867373, 867420, 851093, 870072, 887601, 885561, 871155, 871068, 887499, 867567, 850179, 851280, 876642, 899018, 861569, 882387, 898633, 897800, 0, 860288, 857779, 878570, 874016, 902988, 902006, 903127, 901418, 901418, 912190, 863501, 879867, 878895, 863605, 883799, 900162, 908965, 883661, 894700, 909774, 891038, 874549, 874718, 888710, 910820, 893631, 893498, 910853, 910997, 894556, 871726, 890684, 890886, 863747, 864684, 913100, 914638, 893380, 912272, 911203, 911476, 874878, 891076, 891169, 874548, 894669, 911029, 908083, 894763, 884778, 911230, 891130, 863835, 874847, 888140, 911339, 883942, 894896, 901421, 910927, 871876, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 879677, 873054, 894233, 910509, 908624, 893919, 894042, 910409, 889514, 874144, 874276, 888657, 910621, 894065, 894259, 909530, 910786, 894267, 872407, 890508, 879657, 912737, 912278, 911139, 927870, 906932, 906862, 868421, 884788, 883831, 868463, 888565, 904919, 902811, 888332, 888548, 903905, 885046, 868538, 868556, 882661, 904770, 888288, 887354, 880625, 880769, 880613, 890217, 890394, 891515, 890350, 900719, 891469, 892615, 891429, 901852, 892692, 890505, 900712, 891295, 892481, 880251, 901699, 891345, 892453, 891322, 900608, 891379, 893585, 891452, 900789, 891407, 892569, 890917, 900700, 892370, 880286, 892568, 968341, 900701, 892464, 881698, 865655, 891410, 892599, 901814, 0, 0, 0, 0, 978797, 1029306, 1011559, 1020803, 1049109, 1048276, 1032994, 1033054, 1049732, 1028309, 1012632, 1013140, 1028513, 1050252, 1033937, 1015444, 425774, 425624, 434960, 434875, 435859, 508843, 407086, 396130, 396130, 396130, 0, 0, 392204, 426502, 417151, 517984, 425797, 447891, 426584, 451121, 459144, 425993, 432809, 449262, 429047, 412523, 412391, 426976, 458059, 431472, 432258, 441931, 448103, 432539, 410979, 427059, 429397, 413011, 452751, 459233, 451548, 451382, 448278, 452170, 410337, 428411, 427552, 414277, 451330, 448123, 434420, 434640, 451531, 430849, 414323, 413484, 429218, 451188, 434372, 434496, 450622, 451022, 432868, 411094, 431008, 430737, 430996, 414339, 452616, 441960, 431587, 442521, 440512, 441791, 415872, 420069, 418788, 429679, 434109, 424339, 449702, 434513, 0, 0, 0, 0, 0, 396532, 449276, 423741, 433519, 439429, 428121],

    },]
    };
    echart4.setOption(option)
	window.onresize = echart4.resize;
if (option && typeof option === "object") {
    echart4.setOption(option, true);
    window.onresize = echart4.resize;
}
</script>


