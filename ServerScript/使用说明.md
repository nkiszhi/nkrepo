#  服务器后台

## 启动服务

### 监视运行

在命令行运行`ServerScript`目录下的`scriptmain.py`，运行指令为：

```
python3 scriptmain.py
```

运行效果：

![image-20210711175257875](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711175257875.png)

### 后台运行

在命令行后台运行`ServerScript`目录下的`scriptmain.py`，运行指令为：

```
nohup python3 scriptmain.py &
```

运行效果：

![image-20210711175115982](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711175115982.png)



## 远程脚本控制

在本地端命令行运行`ServerScript`目录下的`instructionsend.py`，运行指令如下：

```
python3 instructionsend.py
```

运行效果：

![image-20210711175715935](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711175715935.png)

输入密码，进入主控程序，界面如下：

![image-20210711175912725](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711175912725.png)

在此界面输入相关指令即可

### 监视页面回显

在连接进行时，如果启动服务的时候是监视运行，可以看见如下显示：

![image-20210711180127032](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711180127032.png)

会回显一条连接ip的信息

当远程控制脚本退出时，监视运行页面显示如下：

![image-20210711180338077](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711180338077.png)



### 使用说明

指令共分为4大类：main，nkaz，nkvs，nkvt；输入`help`可以查看全部指令信息，效果如下：

![image-20210711181247018](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711181247018.png)

![image-20210711181324055](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711181324055.png)

#### main

| 指令输入       | 指令功能                     |
| -------------- | ---------------------------- |
| error          | 显示程序运行时出现的错误信息 |
| stop           | 停止服务                     |
| restart        | 重启服务                     |
| changepassword | 修改密码                     |
| help           | 显示帮助信息                 |
| count          | 显示样本库中所有样本的数量   |
| info           | 显示基本信息                 |
| state          | 显示当前服务运行状态         |
| check          | 检查                         |
| checkdb        | 检查样本库                   |
| exit           | 退出指令控制台               |

#### nkaz

| 指令输入       | 指令功能               |
| -------------- | ---------------------- |
| nkaz count     | 显示nkaz下载的样本数量 |
| nkaz state     | 显示nkaz当前运行状态   |
| nkaz resettime | 修改nkaz定期运行的日期 |
| nkaz stop      | 停止nkaz样本下载服务   |
| nkaz start     | 启动nkaz样本下载服务   |

#### nkvt

| 指令输入      | 指令功能                         |
| ------------- | -------------------------------- |
| nkvt start    | 启动nkvt下载标签服务             |
| nkvt stop     | 停止nkvt下载标签服务             |
| nkvt count    | 显示当前nkvt下载标签数量         |
| nkvt state    | 显示nkvt运行状态                 |
| nkvt move     | 显示nkvt是否处于移动样本标签状态 |
| nkvt download | 显示nkvt是否处于标签下载状态     |

#### nkvs

| 指令输入       | 指令功能             |
| -------------- | -------------------- |
| nkvs start     | 启动nkvs样本下载服务 |
| nkvs stop      | 停止nkvs样本下载服务 |
| nkvs showstate | 显示nkvs运行状态     |
| nkvs count     | 显示nkvs样本下载数目 |

#### 运行实例

所有的运行输入方式都是一样的，这里只使用main中的`state`以及nkvs的`nkvs showstate`进行运行效果演示

```
> state
```

![image-20210711182541291](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711182541291.png)

```
> nkvs showstate
```

![image-20210711182719826](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711182719826.png)





# 前端网页

## 启动服务

在命令行运行`ServerScript`目录下的`webstart.py`，运行指令为：

```
python3 webstart.py
```

运行效果：

![image-20210711183108057](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711183108057.png)

**注意**：在提示中的最后一行会给网页端访问的url，在浏览器中输入url进入到网页

网页显示效果：

![image-20210711183323340](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711183323340.png)

或者可以在网页输入`localhost:5000`进行访问

![image-20210711183416960](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711183416960.png)

访问效果相同

==注意==：在命令行启动服务时，如果关闭了命令终端，网页服务会被关闭。如果想要进行后台运行，则指令为：

```
nohup python3 webstart.py &
```

## 页面功能

> 以下截图等仅为测试时使用显示，实际使用时请以实时显示为准

### 页面切换

![image-20210711183640896](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711183640896.png)

在每个页面左边有一个页面切换栏，点击即可进入到对应功能页面

### 主页面

> logo显示页面

![image-20210711183714991](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711183714991.png)

### 状态信息显示页面

> 显示样本库状态、基本信息、后台服务运行状态、文件分布图等

![image-20210711183843366](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711183843366.png)

### Sha256查询页面

> 通过输入相应sha256值对样本库中样本进行查询

![image-20210711184017620](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711184017620.png)

### 根据时间查询样本页面

> 输入年份，回显样本库中对应年份的样本

![image-20210711184053633](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711184053633.png)



### 根据病毒家族查询样本页面

> 输入病毒家族样本字符串，显示样本库中所有属于该病毒家族的样本

![image-20210711184203291](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711184203291.png)

## 后台监控

在有用户对网页进行相应的访问时，启动服务的命令行终端会回显用户访问的相关信息，如：

![image-20210711184327508](C:\Users\Nirvana\AppData\Roaming\Typora\typora-user-images\image-20210711184327508.png)

格式为：访问方式（ip）-- 访问时间 访问请求方式（如：GET请求方式）和对应访问内容

